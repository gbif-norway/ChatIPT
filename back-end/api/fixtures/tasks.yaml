- model: api.task
  fields:
    name: initial_check_data_suitability
    per_table: false
    attempt_autonomous: false
    text: |-
      GBIF.org is a global database for biodiversity data. Suitable data for publication:
      1. Species Occurrence Data: Records of when (columns for year/month/day, date, etc, or at least general info about when records were gathered) and where (columns describing locality and/or latitude/longitude and/or footprintwkt, etc) a species/what (columns for taxonomy, scientific name, or even higher level taxonomy like Family or Order, etc is fine) was observed or collected. Often (but optionally) also includes WHO made the observation (collector, citizen scientist, researcher, etc). This data may also be e.g. eDNA data even if the species identification only occurs at a higher taxonomic level. We don't need specific observation dates or locations, something general is fine. 
      2. Checklists: Lists of species thematically linked - usually geographically, but could also be by status, trait or other common factor.

      Carefully look at this data, especially the column headings: is it suitable for publication on gbif.org? The data structure is completely unformatted and may be extremely cryptic and messy, so be cautious. Ask about the relationship between different sheets if it's not clear. Keep in mind that it's highly likely at least some of this data is redundant (derived from primary data elsewhere in other sheets). Try to figure out if there is a list of species occurrences (WHAT, WHERE and WHEN), or perhaps a list of names as the main focus, or if it is something else entirely that does not belong on GBIF. 
      
      Generate a first draft Description (approx 3-5 sentences) and Title for the metadata and use this to engage in discussion and ask the user questions to make sure you have understood exactly what their data is. 
      
      If anything's missing, explain that occurrence data needs locations, observation dates and scientific names to be published to GBIF, ask the user for this extra information. If they say they have additional data in another file, tell them they need to upload everything in one spreadsheet and set suitable_for_publication_on_gbif to False using SetBasicMetadata. 
      
      Use short sentences and informal language that cut straight to the point. **Try to only ask the user one question at a time.** Here is an example of bad dialogue:
      "[Description and Title] 
      Could you confirm if this accurately describes your dataset? Additionally, is there any other specific information you would like to add regarding the purpose or methodology of data collection? I'll wait for your input and make any necessary changes to the title and description before finalizing and checking the suitability for GBIF publication."
      Instead, just say:
      "Is there any info we should change or add, like collection methodology/routines?"

      Finally, use SetBasicMetadata to: 
      - save the Title and Description
      - use structure_notes to save anything unusual you discover about the dataset structure or cryptic column names. E.g. if there are two tables rolled into one, if one sheet should be discarded/ignored), if a column called 'R' actually contains a calculated measurement of species richness, etc. 
      - (IMPORTANT) if the data is not suitable for publication, set suitable_for_publication_on_gbif to False. 
      Then call SetAgentTaskToComplete. 
    additional_function: SetBasicMetadata

- model: api.task
  fields:
    name: check_for_images
    per_table: false
    attempt_autonomous: false
    text: |-
      If the user has occurrence data, check for image URLs. If there are none, ask the user if they have an images of the observations they've made which they wish to upload, and if they do explain the images need to be hosted online prior to dataset publication. Suggest a scientific repository such as Zenodo to upload the images, and explain that the URLs must be put in an associatedMedia column as an extra step after image upload. Then tell them to start this process again.
      If the user wishes to get help with uploading images, tell them that you (this system) are currently in beta and are not able to handle image publication for them yet, but that this will come in the future. 

- model: api.task
  fields:
    name: extract_subtables
    per_table: true
    attempt_autonomous: false
    text: |-
      Step 1: 
      ~
      NOTE: This is a challenging task, think it through clearly and carefully, step by step, and ask the user about anything confusing. 

      Separate out any sub tables in this dataframe into new, separate Tables. 
      Non-technical users sometimes squeeze two or more tables into one spreadsheet, which then gets loaded as a single table into the system. New tables may occur horizontally, or vertically, or both!
      A single table should be one block of related data with consistent columns and rows, any headers, metadata lines or summary/total rows can be discarded.  

      Look at the Table snapshots: 
       - use your intelligence
       - **users often merge cells for headings, and when the spreadsheets are loaded the system has UNMERGED those cells, so look out for [UNMERGED CELL] text as indicators that this group of cells was merged as a heading**
       - look at the first few rows, the last few rows
       - search for pattern breaks, particularly ones across columns or rows
       - often users add arbitrary and unnecessary columns like numbering or blank rows as horizontal dividers which should be removed
       - the initial Table headings (which were the sheet names in Excel) may provide clues
       - look at .value_counts(dropna=False)) records for each column - if anything doesn't seem to fit in with the other values take a look at the whole row and 3 rows above and below it to see if you can figure out what is going on
       - ask the user if the data layout is too cryptic to make a guess at

      BE CAREFUL! It's very easy to separate out tables and lose information from columnns or rows. Before doing any table extraction, compare the old table with the new tables, and check to see if you are missing anything. You may have to copy column headers from one table to another, for example.

# Here is an example of a particularly bad user-uploaded spreadsheet (converted simply to a dataframe): 
# | WP2, 64 µm mesh (ind m-3)                       |                     |                     |            |            |       |         | Svartnes 2018 (ind m-3)        |            |
# | ----------------------------------------------- | ------------------- | ------------------- | ---------- | ---------- | ----- | ------- | ------------------------------ | ---------- |
# | Date                                            | 2017                | 2017                | 2018       | 2018       |       |         | WP2, 64 µm mesh                |            |
# | Sample/Net number                               | AVERAGE 20-21.02.17 | AVERAGE 20-21.02.17 | 12.06.2018 | 12.06.2018 |       |         | Date                           | 12.06.2018 | 12.06.2018 |
# | Layer [m]                                       | 50-0 m              | 170-50 m            | 50-0 m     | 170-50 m   |       |         | Sample/Net number              | WP2/64     | WP2/64 |
# | Calanus spp.                                    | 128                 | 259                 | 194        | 562        |       |         | Layer [m]                      | 170-50 m   | 50-0 m |
# | Microcalanus spp.                               | 471                 | 707                 | 16         | 125        |       |         | Calanus spp.                   | 562        | 194 |
# | Cyclopoida nauplii                              | 8724                | 9                   | 8061       | 2          |       |         | Microsetella norvegica nauplii | 110        | 3199 |
# | Fritillaria borealis                            | 5560                | 2                   | 0          | 0          |       |         | Cyclopoida nauplii             | 2          | 8061 |
# | Rotatoria                                       | 607                 | 25                  | 0          | 0          |       |         | Fritillaria borealis           | 0          | 0 |
# | SUM Others                                      | 16721               | 84                  | 223        | 32         |       |         | Rotatoria                      | 0          | 0 |
# |                                                 |                     |                     |            |            |       |         | SUM Others                     | 32         | 223 |
# | Total abundance                                 | 32211               | 1085                | 8495       | 721        |       |         |                                |            |  |
# | Total abundance without nauplii                 | 23487               | 1076                | 433        | 719        |       |         |                                |            |  |
# | Total copeods                                   | 599                 | 966                 | 210        | 687        |       |         |                                |            |  |
# |                                                 |                     |                     |            |            |       |         |                                |            |  |
# | % Microsetella of total zoopl (without nauplii) | #REF!               | #REF!               | #REF!      | #REF!      |       |         |                                |            |  |
# | % Microsetella of total copepods                | #REF!               | #REF!               | #REF!      | #REF!      |       |         |                                |            |  |
# |                                                 |                     |                     |            |            |       |         |                                |            |  |
# | ind/m3                                          |                     |                     |            |            |       |         |                                |            |  |
# | 19/06/2017                                      | M                   | F                   | CIV-CV     | CI-CIII    | SUM   | Nauplii |                                |            |  |
# | 0                                               | 200                 | 4880                | 80         | 160        | 5320  | 3080    |                                |            |  |
# | 10                                              | 622                 | 49518               | 498        | 1493       | 52131 | 33281   |                                |            |  |
# | 20                                              | 1991                | 38818               | 373        | 498        | 41680 | 6096    |                                |            |  |
# | 50                                              | 2280                | 3120                | 80         | 240        | 5720  | 200     |                                |            |  |
# | 90                                              | 600                 | 1720                | 160        | 120        | 2600  | 200     |                                |            |  |
# | 120                                             | 280                 | 1160                | 80         | 320        | 1840  | 1200    |                                |            |  |
# | ind/m3                                          |                     |                     |            |            |       |         |                                |            |  |
# | 21/06/2017                                      | M                   | F                   | CIV-CV     | CI-CIII    | SUM   | Nauplii |                                |            |  |
# | 0                                               | 0                   | 1440                | 0          | 120        | 1560  | 7800    |                                |            |  |
# | 10                                              | 2400                | 40320               | 480        | 1200       | 44400 | 19440   |                                |            |  |
# | 20                                              | 3000                | 17280               | 0          | 360        | 20640 | 4680    |                                |            |  |
# | 50                                              | 440                 | 1160                | 0          | 0          | 1600  | 80      |                                |            |  |
# | 90                                              | 120                 | 1040                | 0          | 0          | 1160  | 120     |                                |            |  |
# | 120                                             | 40                  | 240                 | 0          | 0          | 280   | 40      |                                |            |  |
# |                                                 |                     |                     |            |            |       |         |                                |            |  |

# This should be 4 tables, with the tables with Sum/Total rows discarded. 

# Table A:
# | WP2, 64 µm mesh (ind m-3) |                     |                     |            |            |
# | ------------------------- | ------------------- | ------------------- | ---------- | ---------- |
# | Date                      | 2017                | 2017                | 2018       | 2018       |
# | Sample/Net number         | AVERAGE 20-21.02.17 | AVERAGE 20-21.02.17 | 12.06.2018 | 12.06.2018 |
# | Layer [m]                 | 50-0 m              | 170-50 m            | 50-0 m     | 170-50 m   |
# | Calanus spp.              | 128                 | 259                 | 194        | 562        |
# | Microcalanus spp.         | 471                 | 707                 | 16         | 125        |
# | Cyclopoida nauplii        | 8724                | 9                   | 8061       | 2          |
# | Fritillaria borealis      | 5560                | 2                   | 0          | 0          |
# | Rotatoria                 | 607                 | 25                  | 0          | 0          |
# | SUM Others                | 16721               | 84                  | 223        | 32         |

# Table B:
# | Svartnes 2018 (ind m-3)        |            |
# | ------------------------------ | ---------- |
# | WP2, 64 µm mesh                |            |
# | Date                           | 12.06.2018 | 12.06.2018 |
# | Sample/Net number              | WP2/64     | WP2/64 |
# | Layer [m]                      | 170-50 m   | 50-0 m |
# | Calanus spp.                   | 562        | 194 |
# | Microsetella norvegica nauplii | 110        | 3199 |
# | Cyclopoida nauplii             | 2          | 8061 |
# | Fritillaria borealis           | 0          | 0 |
# | Rotatoria                      | 0          | 0 |
# | SUM Others                     | 32         | 223 |

# Table C:
# | ind/m3     |      |       |        |         |       |         |
# | ---------- | ---- | ----- | ------ | ------- | ----- | ------- |
# | 19/06/2017 | M    | F     | CIV-CV | CI-CIII | SUM   | Nauplii |
# | 0          | 200  | 4880  | 80     | 160     | 5320  | 3080    |
# | 10         | 622  | 49518 | 498    | 1493    | 52131 | 33281   |
# | 20         | 1991 | 38818 | 373    | 498     | 41680 | 6096    |
# | 50         | 2280 | 3120  | 80     | 240     | 5720  | 200     |
# | 90         | 600  | 1720  | 160    | 120     | 2600  | 200     |
# | 120        | 280  | 1160  | 80     | 320     | 1840  | 1200    |

# Table D:
# | ind/m3     |      |       |        |         |       |         |
# | ---------- | ---- | ----- | ------ | ------- | ----- | ------- |
# | 21/06/2017 | M    | F     | CIV-CV | CI-CIII | SUM   | Nauplii |
# | 0          | 0    | 1440  | 0      | 120     | 1560  | 7800    |
# | 10         | 2400 | 40320 | 480    | 1200    | 44400 | 19440   |
# | 20         | 3000 | 17280 | 0      | 360     | 20640 | 4680    |
# | 50         | 440  | 1160  | 0      | 0       | 1600  | 80      |
# | 90         | 120  | 1040  | 0      | 0       | 1160  | 120     |
# | 120        | 40   | 240   | 0      | 0       | 280   | 40      |

# ~ 
# Step 2: 
# ~

# Carefully look at each of the Tables you've created. Do any of them contain the same data and belong together? Should any rows be restructured as columns? In the previous example, Tables A & B belong together, as do Tables C and D. Table AB should look like this: 

# Table AB:

# | Sample details                 | 20-21.02.2017 (50-0 m) | 20-21.02.2017 (170-50 m) | 12.06.2018 (50-0 m) | 12.06.2018 (170-50 m) | Svartnes 12.06.2018 (50-0 m) | Svartnes 12.06.2018 (170-50 m) |
# | ------------------------------ | ---------------------- | ------------------------ | ------------------- | --------------------- | ---------------------------- | ------------------------------ |
# | Calanus spp.                   | 128                    | 259                      | 194                 | 562                   | 194                          | 562                            |
# | Microcalanus spp.              | 471                    | 707                      | 16                  | 125                   | 16                           | 125                            |
# | Pseudocalanus spp.             | 730                    | 35                       | 31                  | 20                    | 31                           | 20                             |
# | Metridia longa                 | 31                     | 209                      | 6                   | 38                    | 6                            | 38                             |
# | Acartia longiremis             | 768                    | 1                        | 273                 | 0                     | 273                          | 0                              |
# | Microsetella norvegica         | 9889                   | 620                      | 8118                | 263                   | 8118                         | 263                            |
# | Oithona similis                | 3510                   | 13                       | 1430                | 3                     | 1430                         | 3                              |
# | Other copepods                 | 108                    | 12                       | 3                   | 3                     | 3                            | 3                              |
# | Calanoida nauplii              | 3525                   | 19                       | 204                 | 59                    | 204                          | 59                             |
# | Microsetella norvegica nauplii | 7181                   | 78                       | 3199                | 110                   | 3199                         | 110                            |
# | Cyclopoida nauplii             | 8724                   | 9                        | 8061                | 2                     | 8061                         | 2                              |
# | Fritillaria borealis           | 5560                   | 2                        | 0                   | 0                     | 0                            | 0                              |
# | Rotatoria                      | 607                    | 25                       | 0                   | 0                     | 0                            | 0                              |

- model: api.task
  fields:
    name: join_tables
    per_table: false
    attempt_autonomous: false
    text: |-
      Carefully look at all of the Tables and decide if any contain the same data and belong together. Quite often users split up data by location (all observations at site 1 in one sheet, all observations at site 2 in another sheet) or taxonomic group (all raptors in one sheet, all other birds in another), for example. What we're aiming for is single Tables for all of the same sort of data - all species observations or species names should go into a single Table, all measurements/facts should go into another Table. Look for patterns in the different Tables, look at the data content of each Table, think about this critically and analytically. Users are human, illogical and unreliable - they may name and order column headings differently from one Table to the next, so you need to be on your toes with this one.

      If Tables make sense as they are, keep them separate. For example, if all species observations are in one Table, and additional variables are in another Table, leave them as is. 

      You can also split Tables and extract the additional MeasurementOrFact data into a different Table, if you think that makes sense.

- model: api.task
  fields:
    name: clarify_columns
    per_table: true
    attempt_autonomous: false
    text: |-
      When users publish data, they often create spreadsheets with cryptic information as they tend to write things with only themselves in mind. This task is to simply clarify what actual data we have in the spreadsheet, beyond species observation data columns (WHAT was observed, WHERE it was observed, WHEN it was observed and optionally WHO observed it) which should already be defined.
      Take a deep breath, and think this through step-by-step.
      -
      Aim 1: examine the data presented in this table carefully: 
      a) Are the column heading meanings clear and reflecting the data in each column? 
      b) If any of the first few columns are row headings (i.e. this is a pivot table of some kind), do you understand what the values in there mean? Should they be renamed? 
      
      Note that users sometimes make multiple header columns for pivot tables - if you notice this you can go ahead and flatten them first. Make some intelligent guesses and fix things up as best you can, but ask the user if there's anything you're baffled by. 
      -
      Aim 2: once you have a good understanding of the column headings and data, rename cryptic columns (and/or data values) to make them immediately understandable. 
      -
      Aim 3: explain any more confusing aspects of the data/structure by adding a short explanation using the SetBasicMetadata function. 

      To achieve these 3 aims, start by asking the user one question at a time, based on the data in the table. Wait for the user's response before asking the next question.
      To achieve the desired conversational flow, here is an example of how the interaction should look:

      Table example:
        xA1	xA2	xB1
      Acartia_longiremis	13.2	0	0
      Aetideopsis_rostrata	0	20.1	0
      Calanus_finmarchicus	12.1	12	0
      Calanus_glacialis	4	3.2	3.2
      Calanus_hyperboreus	2.9	0	2.8
      S	35	35.67	36

      Agent: I can see the first column obviously contains scientific names, so I think the next columns are the number of species you found in different sites, and the column headings identify the sample sites, right?
      User: Yes, well sort of, it's actually %biomass of each species at different sites, except the last row (S) is ocean salinity
      Agent: [runs Python function to rename all other columns and last row to ocean salinity]
      Agent: [Calls SetBasicMetadata and adds additional information to dataset Description: "Table ID 82 is wide format/pivot table with the first column being %biomass of species for different sample sites. NB the last row contains different data and should be treated separately."]
  additional_function: SetBasicMetadata

- model: api.task
  fields:
    name: drop_unnecessary_columns
    per_table: true
    attempt_autonomous: false
    text: |-
      Drop any unnecessary rows and columns containing data which has been derived from primary data. Particularly, look out for SUM/TOTAL and formula rows at the bottom of the dataframe, and SUM/TOTAL columns at the end of it. If there are any other rows or columns which are not necessary or seem meaningless, remove those too.
      IMPORTANT NOTE 1: Be extremely careful when dropping rows or columns because of nan/None values, usually these contain important data even if the value is None. Look critically at the rows you plan to delete BEFORE you delete them, and check that they really are unnecessary. 
      IMPORTANT NOTE 2: Be sure not to drop a row when you should be dropping a column, or a selection of cells. I.e. don't just check cell A2, notice it contains a formula, and decide to drop the entire column based on that. Check that A3, A4, ... A100, etc also contain formulas, and if they don't check across and see if B2, C2 ... J2 perhaps contain formulas (meaning you should instead drop the row). 

- model: api.task
  fields:
    name: de_crosstab  # Convert crosstab/pivot to long.
    per_table: true
    attempt_autonomous: true
    text: >  
      Is this table in crosstab, wide or pivot format? Often users have a crosstab of species x locations, with the value cells being individualCount or organismQuantity. If this is the case, convert the crosstab to long format, label the new column to whatever you think is correct, but if you are not sure check in with the user. Don't forget to save changes to the database before marking this Task as complete. 
      
      One possible complication is that often users have multiple headers, which will need to be dealt with separately. Here is an example: 

      Original table:
      Net	 64 µm mesh (ind m-3)			
      Year	2017	2017	2018	2018
      Sampled	 20-21.02.17	20-21.02.17	12.06.2018	12.06.2018
      Layer [m]	50-0 m	170-50 m	50-0 m	170-50 m
      Calanus spp.	128	259	194	562
      Microcalanus spp.	471	707	16	125
      Cyclopoida nauplii	8724	9	8061	2
      Fritillaria borealis	5560	2	0	0
      ...

      The first 4 rows contain variables about the location/date sampled and are essentially header rows, the following rows contain species + counts for each location. Each of the header rows needs to become a column, like this:

      scientificName	individualCount	Layer [m]	organismQuantityType	eventDate	samplingProtocol
      Calanus spp.	128	50-0 m	AVERAGE	 20-21.02.17	 64 µm mesh net (ind m-3)
      Microcalanus spp.	471	50-0 m	AVERAGE	 20-21.02.17	 64 µm mesh net (ind m-3)
      Cyclopoida nauplii	8724	50-0 m	AVERAGE	 20-21.02.17	 64 µm mesh net (ind m-3)
      Fritillaria borealis	5560	50-0 m	AVERAGE	 20-21.02.17	 64 µm mesh net (ind m-3)
      Calanus spp.	259	170-50 m	AVERAGE	20-21.02.17	 64 µm mesh net (ind m-3)
      Microcalanus spp.	707	170-50 m	AVERAGE	20-21.02.17	 64 µm mesh net (ind m-3)
      Cyclopoida nauplii	9	170-50 m	AVERAGE	20-21.02.17	 64 µm mesh net (ind m-3)
      Fritillaria borealis	2	170-50 m	AVERAGE	20-21.02.17	 64 µm mesh net (ind m-3)
      Calanus spp.	194	50-0 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      Microcalanus spp.	16	50-0 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      Cyclopoida nauplii	8061	50-0 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      Fritillaria borealis	0	50-0 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      Calanus spp.	562	170-50 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      Microcalanus spp.	125	170-50 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      Cyclopoida nauplii	2	170-50 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      Fritillaria borealis	0	170-50 m	AVERAGE	12.06.2018	 64 µm mesh net (ind m-3)
      ...
    
- model: api.task
  fields:
    name: set_core_and_extensions
    per_table: false
    attempt_autonomous: false
    text: |-
      Carefully examine the contents of each of these dataframes. They need to be combined together into a Darwin Core archive, with one core table and an optional MeasurementOrFact extension Table. Decide on 1) either an Occurrence or Checklist (taxonomy) DwC core, and 2) whether adding a MeasurementOrFact Table to store extra data is necessary.
      Pick and choose from these common Occurrence DwC fields: 
       - basisOfRecord REQUIRED (valid values: MaterialEntity, PreservedSpecimen, FossilSpecimen, LivingSpecimen, MaterialSample, HumanObservation, MachineObservation), [NOTE: you will almost always have to create and fill in this column for the user]
       - eventDate REQUIRED (must be ISO format) OR 3 columns: a year, month & day
       - locality
       - locationRemarks
       - waterBody (if a marine or aquatic occurrence, e.g. Baltic Sea, Hudson River)
       - islandGroup
       - island
       - minimumElevationInMeters
       - maximumElevationInMeters
       - minimumDepthInMeters
       - maximumDepthInMeters
       - minimumDistanceAboveSurfaceInMeters
       - maximumDistanceAboveSurfaceInMeters
       - country
       - decimalLatitude
       - decimalLongitude
       - geodeticDatum (SRS or geodeticDatum pertaining to decimalLatitude and decimalLongitude)
       - coordinateUncertaintyInMeters
       - fieldNotes
       - recordedBy (collector/observer's name)
       - recordedByID (often ORCID)
       - scientificName REQUIRED
       - kingdom REQUIRED, [NOTE: you may have to fill this in for the user]
       - individualCount or organismQuantity/organismQuantityType (IMPORTANT: This is where abundance or number/counts of individuals go, NOT in MeasurementOrFact)
       - occurrenceRemarks (can hold any miscellaneous information)
       - sex
       - lifeStage
       - behavior (e.g. roosting, foraging, running)
       - vitality (valid values: alive, dead, mixedLot, uncertain, notAssessed)
       - establishmentMeans (valid values: native, nativeReintroduced, introduced, introducedAssistedColonisation, vagrant, uncertain)
       - degreeOfEstablishment (valid values: native, captive, cultivated, released, failing, casual, reproducing, established, colonising, invasive, widespreadInvasive)
       - occurrenceStatus (use this for plot sample data or similar, valid values: present, absent)
       - preparations (preparation/preservation methods, e.g. fossil, cast, photograph, DNA extract)
       - associatedSequences (list of associated genetic sequence information, e.g. http://www.ncbi.nlm.nih.gov/nuccore/U34853.1)
       - habitat
       - samplingProtocol (e.g. UV light trap, mist net, bottom trawl)
       - samplingEffort (e.g. 40 trap-nights, 10 observer-hours, 10 km by foot)

      Common Checklist DwC fields
       - taxonID
       - scientificName
       - kingdom
       - taxonRemarks

      NOTE 1: The MeasurementOrFact extension should be used to store facts or measurements which do not fit into the core fields or where there are multiple measurements per field. Examples: length, weight, temperature, salinity, age, growth rate, symbiotic relationships, predator-prey interactions, etc. DO NOT use it for individual counts or abundance, those numbers should go into individualCount or organismQuantity/organismQuantityType.
      NOTE 2: In almost all cases, if you are publishing Occurrence data, you should discard any Tables containing summary taxonomy information that a user may have gathered - that should not get published. 

      Your task is now to: 
      1) Discuss your recommendations for DwC core and extension with the user, note that extensions are optional. 
      2) Rename the core columns in the Tables to DwC fields (see above for common fields), if column data/names are cryptic and difficult to understand, ask the user about them. If you think it's necessary, use SetBasicMetadata to update the dataset Title and Description to better reflect the dataset.
      3) Organize the Tables, joining or deleting dataframes as necessary so the data structure resembles what is required (see final examples). 
      4) Call the SetAgentTaskToComplete function
    additional_function: SetBasicMetadata

- model: api.task
  fields:
    name: unique_ids
    per_table: true
    attempt_autonomous: true
    text: >  
      Ensure that every row for each Table has a unique identifier (e.g. occurrenceID, measurementID, etc). If there isn't an obvious one present, generate uuids.

- model: api.task
  fields:
    name: validation
    per_table: true
    attempt_autonomous: true
    text: |-
      Check each of the columns (which should all be darwin core fields) for validation errors. 
      Here is a list of all allowed Darwin Core terms. Don't worry about which are required fields, we've already checked those. 

      ---
      Record-level:
        type: The nature or genre of the resource. Egs - StillImage / MovingImage / Sound / PhysicalObject / Event / Text
        modified: The most recent date-time on which the resource was changed.
        language: A language of the resource.
        references: A related resource that is referenced, cited, or otherwise pointed to by the described resource.
        institutionID: An identifier for the institution having custody of the object(s) or information referred to in the record. Egs - <a href="https://ror.org/015hz7p22">https://ror.org/015hz7p22</a> / <a href="http://grscicoll.org/institution/museum-southwestern-biology">http://grscicoll.org/institution/museum-southwestern-biology</a> / <a href="https://www.gbif.org/grscicoll/institution/e3d4dcc4-81e2-444c-8a5c-41d1044b5381">https://www.gbif.org/grscicoll/institution/e3d4dcc4-81e2-444c-8a5c-41d1044b5381</a>
        collectionID: An identifier for the collection or dataset from which the record was derived.
        institutionCode: The name (or acronym) in use by the institution having custody of the object(s) or information referred to in the record. Egs - MVZ / FMNH / CLO / UCMP
        collectionCode: The name, acronym, coden, or initialism identifying the collection or data set from which the record was derived. Egs - Mammals / Hildebrandt / EBIRD / VP
        ownerInstitutionCode: The name (or acronym) in use by the institution having ownership of the object(s) or information referred to in the record. Egs - NPS / APN / InBio
        basisOfRecord: The specific nature of the data record. Egs - MaterialEntity / PreservedSpecimen / FossilSpecimen / LivingSpecimen / MaterialSample / Event / HumanObservation / MachineObservation / Taxon / Occurrence / MaterialCitation
        informationWithheld: Additional information that exists, but that has not been shared in the given record. Egs - location information not given for endangered species / collector identities withheld | ask about tissue samples
        dynamicProperties: A list of additional measurements, facts, characteristics, or assertions about the record. Meant to provide a mechanism for structured content. Egs - {"heightInMeters":1.5} / {"targusLengthInMeters":0.014, "weightInGrams":120} / {"natureOfID":"expert identification", "identificationEvidence":"cytochrome B sequence"} / {"relativeHumidity":28, "airTemperatureInCelsius":22, "sampleSizeInKilograms":10} / {"aspectHeading":277, "slopeInDegrees":6} / {"iucnStatus":"vulnerable", "taxonDistribution":"Neuquén, Argentina"}
      Occurrence:
        occurrenceID: An identifier for the dwc:Occurrence (as opposed to a particular digital record of the dwc:Occurrence). In the absence of a persistent global unique identifier, construct one from a combination of identifiers in the record that will most closely make the dwc:occurrenceID globally unique. Egs - <a href="http://arctos.database.museum/guid/MSB:Mamm:233627">http://arctos.database.museum/guid/MSB:Mamm:233627</a> / 000866d2-c177-4648-a200-ead4007051b9 / urn:catalog:UWBM:Bird:89776
        catalogNumber: An identifier (preferably unique) for the record within the data set or collection. Egs - 145732 / 145732a / 2008.1334 / R-4313
        recordNumber: An identifier given to the dwc:Occurrence at the time it was recorded. Often serves as a link between field notes and a dwc:Occurrence record, such as a specimen collector's number.
        recordedBy: A list (concatenated and separated) of names of people, groups, or organizations responsible for recording the original dwc:Occurrence. The primary collector or observer, especially one who applies a personal identifier (dwc:recordNumber), should be listed first. Egs - José E. Crespo
        recordedByID: A list (concatenated and separated) of the globally unique identifier for the person, people, groups, or organizations responsible for recording the original dwc:Occurrence.
        individualCount: The number of individuals present at the time of the dwc:Occurrence. Egs - 0 / 1 / 25
        organismQuantity: A number or enumeration value for the quantity of dwc:Organisms.
        organismQuantityType: The type of quantification system used for the quantity of dwc:Organisms.
        sex: The sex of the biological individual(s) represented in the dwc:Occurrence. Egs - female / male / hermaphrodite
        lifeStage: The age class or life stage of the dwc:Organism(s) at the time the dwc:Occurrence was recorded. Egs - zygote / larva / juvenile / adult / seedling / flowering / fruiting
        reproductiveCondition: The reproductive condition of the biological individual(s) represented in the dwc:Occurrence. Egs - non-reproductive / pregnant / in bloom / fruit-bearing
        caste: Categorisation of individuals for eusocial species (including some mammals and arthropods). Egs - queen / male alate / intercaste / minor worker / soldier / ergatoid
        behavior: The behavior shown by the subject at the time the dwc:Occurrence was recorded. Egs - roosting / foraging / running
        vitality: An indication of whether a dwc:Organism was alive or dead at the time of collection or observation. Egs - alive / dead / mixedLot / uncertain / notAssessed
        establishmentMeans: Statement about whether a dwc:Organism has been introduced to a given place and time through the direct or indirect activity of modern humans. Egs - native / nativeReintroduced / introduced / introducedAssistedColonisation / vagrant / uncertain
        degreeOfEstablishment: The degree to which a dwc:Organism survives, reproduces, and expands its range at the given place and time. Egs - native / captive / cultivated / released / failing / casual / reproducing / established / colonising / invasive / widespreadInvasive
        pathway: The process by which a dwc:Organism came to be in a given place at a given time. Egs - releasedForUse / otherEscape / transportContaminant / transportStowaway / corridor / unaided
        georeferenceVerificationStatus: A categorical description of the extent to which the georeference has been verified to represent the best possible spatial description for the dcterms:Location of the dwc:Occurrence. Egs - unable to georeference / requires georeference / requires verification / verified by data custodian / verified by contributor
        occurrenceStatus: A statement about the presence or absence of a dwc:Taxon at a dcterms:Location. Egs - present / absent
        associatedMedia: A list (concatenated and separated) of identifiers (publication, global unique identifier, URI) of media associated with the dwc:Occurrence.
        associatedOccurrences: A list (concatenated and separated) of identifiers of other dwc:Occurrence records and their associations to this dwc:Occurrence. Egs - "parasite collected from":"<a href="https://arctos.database.museum/guid/MSB:Mamm:215895?seid=950760">https://arctos.database.museum/guid/MSB:Mamm:215895?seid=950760</a>" / "encounter previous to":"<a href="http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3175067">http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3175067</a>" | "encounter previous to":"<a href="http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3177393">http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3177393</a>" | "encounter previous to":"<a href="http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3177394">http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3177394</a>" | "encounter previous to":"<a href="http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3177392">http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3177392</a>" | "encounter previous to":"<a href="http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3609139">http://arctos.database.museum/guid/MSB:Mamm:292063?seid=3609139</a>"
        associatedReferences: A list (concatenated and separated) of identifiers (publication, bibliographic reference, global unique identifier, URI) of literature associated with the dwc:Occurrence. Egs - <a href="http://www.sciencemag.org/cgi/content/abstract/322/5899/261">http://www.sciencemag.org/cgi/content/abstract/322/5899/261</a> / Christopher J. Conroy, Jennifer L. Neuwald. 2008. Phylogeographic study of the California vole, Microtus californicus Journal of Mammalogy, 89(3):755-767. / Steven R. Hoofer and Ronald A. Van Den Bussche. 2001. Phylogenetic Relationships of Plecotine Bats and Allies Based on Mitochondrial Ribosomal Sequences. Journal of Mammalogy 82(1):131-137. | Walker, Faith M., Jeffrey T. Foster, Kevin P. Drees, Carol L. Chambers. 2014. Spotted bat (Euderma maculatum) microsatellite discovery using illumina sequencing. Conservation Genetics Resources.
        associatedTaxa: A list (concatenated and separated) of identifiers or names of dwc:Taxon records and the associations of this dwc:Occurrence to each of them. Egs - "host":"Quercus alba" / "host":"gbif.org/species/2879737" / "parasitoid of":"Cyclocephala signaticollis" | "predator of":"Apis mellifera"
        otherCatalogNumbers: A list (concatenated and separated) of previous or alternate fully qualified catalog numbers or other human-used identifiers for the same dwc:Occurrence, whether in the current or any other data set or collection. Egs - FMNH:Mammal:1234 / NPS YELLO6778 | MBG 33424
        occurrenceRemarks: Comments or notes about the dwc:Occurrence.
      Organism:
        organismID: An identifier for the dwc:Organism instance (as opposed to a particular digital record of the dwc:Organism). May be a globally unique identifier or an identifier specific to the data set.
        organismName: A textual name or label assigned to a dwc:Organism instance. Egs - Huberta / Boab Prison Tree / J pod
        organismScope: A description of the kind of dwc:Organism instance. Can be used to indicate whether the dwc:Organism instance represents a discrete organism or if it represents a particular type of aggregation. Egs - multicellular organism / virus / clone / pack / colony
        associatedOrganisms: A list (concatenated and separated) of identifiers of other dwc:Organisms and the associations of this dwc:Organism to each of them. Egs - "sibling of":"<a href="http://arctos.database.museum/guid/DMNS:Mamm:14171">http://arctos.database.museum/guid/DMNS:Mamm:14171</a>" / "parent of":"<a href="http://arctos.database.museum/guid/MSB:Mamm:196208">http://arctos.database.museum/guid/MSB:Mamm:196208</a>" | "parent of":"<a href="http://arctos.database.museum/guid/MSB:Mamm:196523">http://arctos.database.museum/guid/MSB:Mamm:196523</a>" | "sibling of":"<a href="http://arctos.database.museum/guid/MSB:Mamm:142638">http://arctos.database.museum/guid/MSB:Mamm:142638</a>"
        previousIdentifications: A list (concatenated and separated) of previous assignments of names to the dwc:Organism. Egs - Chalepidae / Pinus abies / Anthus sp., field ID by G. Iglesias | Anthus correndera, expert ID by C. Cicero 2009-02-12 based on morphology
        organismRemarks: Comments or notes about the dwc:Organism instance.
      MaterialEntity:
        materialEntityID: An identifier for a particular instance of a dwc:MaterialEntity.
        preparations: A list (concatenated and separated) of preparations and preservation methods for a dwc:MaterialEntity. Egs - fossil / cast / photograph / DNA extract / skin | skull | skeleton / whole animal (ETOH) | tissue (EDTA)
        disposition: The current state of a dwc:MaterialEntity with respect to a collection. Egs - in collection / missing / on loan / used up / destroyed / deaccessioned
        verbatimLabel: The content of this term should include no embellishments, prefixes, headers or other additions made to the text. Abbreviations must not be expanded and supposed misspellings must not be corrected. Lines or breakpoints between blocks of text that could be verified by seeing the original labels or images of them may be used. Examples of material entities include preserved specimens, fossil specimens, and material samples. Best practice is to use UTF-8 for all characters. Best practice is to add comment “verbatimLabel derived from human transcription” in dwc:occurrenceRemarks.
        associatedSequences: A list (concatenated and separated) of identifiers (publication, global unique identifier, URI) of genetic sequence information associated with the dwc:MaterialEntity. Egs - <a href="http://www.ncbi.nlm.nih.gov/nuccore/U34853.1">http://www.ncbi.nlm.nih.gov/nuccore/U34853.1</a> / <a href="http://www.ncbi.nlm.nih.gov/nuccore/GU328060">http://www.ncbi.nlm.nih.gov/nuccore/GU328060</a> | <a href="http://www.ncbi.nlm.nih.gov/nuccore/AF326093">http://www.ncbi.nlm.nih.gov/nuccore/AF326093</a>
        materialEntityRemarks: Comments or notes about the dwc:MaterialEntity instance. Egs - found in association with charred remains / some original fragments missing
      MaterialSample:
        materialSampleID: An identifier for the dwc:MaterialSample (as opposed to a particular digital record of the dwc:MaterialSample). In the absence of a persistent global unique identifier, construct one from a combination of identifiers in the record that will most closely make the dwc:materialSampleID globally unique.
      Event:
        eventID: An identifier for the set of information associated with a dwc:Event (something that occurs at a place and time). May be a global unique identifier or an identifier specific to the data set.
        parentEventID: An identifier for the broader dwc:Event that groups this and potentially other dwc:Events.
        eventType: The nature of the dwc:Event. Egs - Sample / Observation / Site Visit / Biotic Interaction / Bioblitz / Expedition / Survey / Project
        fieldNumber: An identifier given to the dwc:Event in the field. Often serves as a link between field notes and the dwc:Event.
        eventDate: The date-time or interval during which a dwc:Event occurred. For occurrences, this is the date-time when the dwc:Event was recorded. Not suitable for a time in a geological context.
        eventTime: The time or interval during which a dwc:Event occurred.
        startDayOfYear: The earliest integer day of the year on which the dwc:Event occurred (1 for January 1, 365 for December 31, except in a leap year, in which case it is 366).
        endDayOfYear: The latest integer day of the year on which the dwc:Event occurred (1 for January 1, 365 for December 31, except in a leap year, in which case it is 366).
        year: The four-digit year in which the dwc:Event occurred, according to the Common Era Calendar. Egs - 1160 / 2008
        month: The integer month in which the dwc:Event occurred.
        day: The integer day of the month on which the dwc:Event occurred. Egs - 9 / 28
        verbatimEventDate: The verbatim original representation of the date and time information for a dwc:Event. Egs - spring 1910 / Marzo 2002 / 1999-03-XX / 17IV1934
        habitat: A category or description of the habitat in which the dwc:Event occurred. Egs - oak savanna / pre-cordilleran steppe
        samplingProtocol: The names of, references to, or descriptions of the methods or protocols used during a dwc:Event. Egs - UV light trap / mist net / bottom trawl / ad hoc observation | point count / Penguins from space faecal stains reveal the location of emperor penguin colonies, <a href="https://doi.org/10.1111/j.1466-8238.2009.00467.x">https://doi.org/10.1111/j.1466-8238.2009.00467.x</a> / Takats et al. 2001. Guidelines for Nocturnal Owl Monitoring in North America. Beaverhill Bird Observatory and Bird Studies Canada, Edmonton, Alberta. 32 pp., <a href="http://www.bsc-eoc.org/download/Owl.pdf">http://www.bsc-eoc.org/download/Owl.pdf</a>
        sampleSizeValue: A numeric value for a measurement of the size (time duration, length, area, or volume) of a sample in a sampling dwc:Event.
        sampleSizeUnit: The unit of measurement of the size (time duration, length, area, or volume) of a sample in a sampling dwc:Event. Egs - minute / hour / day / metre / square metre / cubic metre
        samplingEffort: The amount of effort expended during a dwc:Event. Egs - 40 trap-nights / 10 observer-hours / 10 km by foot / 30 km by car
        fieldNotes: One of a) an indicator of the existence of, b) a reference to (publication, URI), or c) the text of notes taken in the field about the dwc:Event.
        eventRemarks: Comments or notes about the dwc:Event.
      Location:
        locationID: An identifier for the set of dcterms:Location information. May be a global unique identifier or an identifier specific to the data set.
        higherGeographyID: An identifier for the geographic region within which the dcterms:Location occurred.
        higherGeography: A list (concatenated and separated) of geographic names less specific than the information captured in the dwc:locality term. Egs - North Atlantic Ocean
        continent: The name of the continent in which the dcterms:Location occurs. Egs - Africa / Antarctica / Asia / Europe / North America / Oceania / South America
        waterBody: The name of the water body in which the dcterms:Location occurs. Egs - Indian Ocean / Baltic Sea / Hudson River / Lago Nahuel Huapi
        islandGroup: The name of the island group in which the dcterms:Location occurs. Egs - Alexander Archipelago / Archipiélago Diego Ramírez / Seychelles
        island: The name of the island on or near which the dcterms:Location occurs. Egs - Nosy Be / Bikini Atoll / Vancouver / Viti Levu / Zanzibar
        country: The name of the country or major administrative unit in which the dcterms:Location occurs. Egs - Denmark / Colombia / España
        countryCode: The standard code for the country in which the dcterms:Location occurs. Egs - AR / SV
        stateProvince: The name of the next smaller administrative region than country (state, province, canton, department, region, etc.) in which the dcterms:Location occurs. Egs - Montana / Minas Gerais / Córdoba
        county: The full, unabbreviated name of the next smaller administrative region than stateProvince (county, shire, department, etc.) in which the dcterms:Location occurs. Egs - Missoula / Los Lagos / Mataró
        municipality: The full, unabbreviated name of the next smaller administrative region than county (city, municipality, etc.) in which the dcterms:Location occurs. Do not use this term for a nearby named place that does not contain the actual dcterms:Location. Egs - Holzminden / Araçatuba / Ga-Segonyana
        locality: The specific description of the place. Egs - Bariloche, 25 km NNE via Ruta Nacional 40 (=Ruta 237) / Queets Rainforest, Olympic National Park
        verbatimLocality: The original textual description of the place.
        minimumElevationInMeters: The lower limit of the range of elevation (altitude, usually above sea level), in meters. Egs - -100 / 802
        maximumElevationInMeters: The upper limit of the range of elevation (altitude, usually above sea level), in meters. Egs - -205 / 1236
        verbatimElevation: The original description of the elevation (altitude, usually above sea level) of the Location.
        verticalDatum: The vertical datum used as the reference upon which the values in the elevation terms are based. Egs - EGM84 / EGM96 / EGM2008 / PGM2000A / PGM2004 / PGM2006 / PGM2007 / epsg:7030 / unknown
        minimumDepthInMeters: The lesser depth of a range of depth below the local surface, in meters. Egs - 0 / 100
        maximumDepthInMeters: The greater depth of a range of depth below the local surface, in meters. Egs - 0 / 200
        verbatimDepth: The original description of the depth below the local surface.
        minimumDistanceAboveSurfaceInMeters: The lesser distance in a range of distance from a reference surface in the vertical direction, in meters. Use positive values for locations above the surface, negative values for locations below. If depth measures are given, the reference surface is the location given by the depth, otherwise the reference surface is the location given by the elevation.
        maximumDistanceAboveSurfaceInMeters: The greater distance in a range of distance from a reference surface in the vertical direction, in meters. Use positive values for locations above the surface, negative values for locations below. If depth measures are given, the reference surface is the location given by the depth, otherwise the reference surface is the location given by the elevation.
        locationAccordingTo: Information about the source of this dcterms:Location information. Could be a publication (gazetteer), institution, or team of individuals. Egs - Getty Thesaurus of Geographic Names / GADM
        locationRemarks: Comments or notes about the dcterms:Location.
        decimalLatitude: The geographic latitude (in decimal degrees, using the spatial reference system given in dwc:geodeticDatum) of the geographic center of a dcterms:Location. Positive values are north of the Equator, negative values are south of it. Legal values lie between -90 and 90, inclusive.
        decimalLongitude: The geographic longitude (in decimal degrees, using the spatial reference system given in dwc:geodeticDatum) of the geographic center of a dcterms:Location. Positive values are east of the Greenwich Meridian, negative values are west of it. Legal values lie between -180 and 180, inclusive.
        geodeticDatum: The ellipsoid, geodetic datum, or spatial reference system (SRS) upon which the geographic coordinates given in dwc:decimalLatitude and dwc:decimalLongitude are based. Egs - EPSG:4326 / WGS84 / NAD27 / Campo Inchauspe / European 1950 / Clarke 1866 / unknown
        coordinateUncertaintyInMeters: The horizontal distance (in meters) from the given dwc:decimalLatitude and dwc:decimalLongitude describing the smallest circle containing the whole of the dcterms:Location. Leave the value empty if the uncertainty is unknown, cannot be estimated, or is not applicable (because there are no coordinates). Zero is not a valid value for this term.
        coordinatePrecision: A decimal representation of the precision of the coordinates given in the dwc:decimalLatitude and dwc:decimalLongitude.
        pointRadiusSpatialFit: The ratio of the area of the point-radius (dwc:decimalLatitude, dwc:decimalLongitude, dwc:coordinateUncertaintyInMeters) to the area of the true (original, or most specific) spatial representation of the dcterms:Location. Legal values are 0, greater than or equal to 1, or undefined. A value of 1 is an exact match or 100% overlap. A value of 0 should be used if the given point-radius does not completely contain the original representation. The dwc:pointRadiusSpatialFit is undefined (and should be left empty) if the original representation is any geometry without area (e.g., a point or polyline) and without uncertainty and the given georeference is not that same geometry (without uncertainty). If both the original and the given georeference are the same point, the dwc:pointRadiusSpatialFit is 1. Egs - 0 / 1 / 1.5708
        verbatimCoordinates: The verbatim original spatial coordinates of the dcterms:Location. The coordinate ellipsoid, geodeticDatum, or full Spatial Reference System (SRS) for these coordinates should be stored in dwc:verbatimSRS and the coordinate system should be stored in dwc:verbatimCoordinateSystem. Egs - 41 05 54S 121 05 34W / 17T 630000 4833400
        verbatimLatitude: The verbatim original latitude of the dcterms:Location. The coordinate ellipsoid, geodeticDatum, or full Spatial Reference System (SRS) for these coordinates should be stored in dwc:verbatimSRS and the coordinate system should be stored in dwc:verbatimCoordinateSystem.
        verbatimLongitude: The verbatim original longitude of the dcterms:Location. The coordinate ellipsoid, geodeticDatum, or full Spatial Reference System (SRS) for these coordinates should be stored in dwc:verbatimSRS and the coordinate system should be stored in dwc:verbatimCoordinateSystem.
        verbatimCoordinateSystem: The coordinate format for the dwc:verbatimLatitude and dwc:verbatimLongitude or the dwc:verbatimCoordinates of the dcterms:Location. Egs - decimal degrees / degrees decimal minutes / degrees minutes seconds / UTM
        verbatimSRS: The ellipsoid, geodetic datum, or spatial reference system (SRS) upon which coordinates given in dwc:verbatimLatitude and dwc:verbatimLongitude, or dwc:verbatimCoordinates are based. Egs - unknown / EPSG:4326 / WGS84 / NAD27 / Campo Inchauspe / European 1950 / Clarke 1866
        footprintWKT: A Well-Known Text (WKT) representation of the shape (footprint, geometry) that defines the dcterms:Location. A dcterms:Location may have both a point-radius representation (see dwc:decimalLatitude) and a footprint representation, and they may differ from each other.
        footprintSRS: The ellipsoid, geodetic datum, or spatial reference system (SRS) upon which the geometry given in dwc:footprintWKT is based. Egs - epsg:4326
        footprintSpatialFit: The ratio of the area of the dwc:footprintWKT to the area of the true (original, or most specific) spatial representation of the dcterms:Location. Legal values are 0, greater than or equal to 1, or undefined. A value of 1 is an exact match or 100% overlap. A value of 0 should be used if the given dwc:footprintWKT does not completely contain the original representation. The dwc:footprintSpatialFit is undefined (and should be left empty) if the original representation is any geometry without area (e.g., a point or polyline) and without uncertainty and the given georeference is not that same geometry (without uncertainty). If both the original and the given georeference are the same point, the dwc:footprintSpatialFit is 1. Egs - 0 / 1 / 1.5708
        georeferencedBy: A list (concatenated and separated) of names of people, groups, or organizations who determined the georeference (spatial representation) for the dcterms:Location. Egs - Brad Millen (ROM) / Kristina Yamamoto | Janet Fang
        georeferencedDate: The date on which the dcterms:Location was georeferenced.
        georeferenceProtocol: A description or reference to the methods used to determine the spatial footprint, coordinates, and uncertainties.
        georeferenceSources: A list (concatenated and separated) of maps, gazetteers, or other resources used to georeference the dcterms:Location, described specifically enough to allow anyone in the future to use the same resources. Egs - <a href="https://www.geonames.org/">https://www.geonames.org/</a> / USGS 1:24000 Florence Montana Quad 1967 | Terrametrics 2008 on Google Earth / GeoLocate
        georeferenceRemarks: Notes or comments about the spatial description determination, explaining assumptions made in addition or opposition to the those formalized in the method referred to in dwc:georeferenceProtocol.
      GeologicalContext:
        geologicalContextID: An identifier for the set of information associated with a dwc:GeologicalContext (the location within a geological context, such as stratigraphy). May be a global unique identifier or an identifier specific to the data set.
        earliestEonOrLowestEonothem: The full name of the earliest possible geochronologic eon or lowest chrono-stratigraphic eonothem or the informal name ("Precambrian") attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Phanerozoic / Proterozoic
        latestEonOrHighestEonothem: The full name of the latest possible geochronologic eon or highest chrono-stratigraphic eonothem or the informal name ("Precambrian") attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Phanerozoic / Proterozoic
        earliestEraOrLowestErathem: The full name of the earliest possible geochronologic era or lowest chronostratigraphic erathem attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Cenozoic / Mesozoic
        latestEraOrHighestErathem: The full name of the latest possible geochronologic era or highest chronostratigraphic erathem attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Cenozoic / Mesozoic
        earliestPeriodOrLowestSystem: The full name of the earliest possible geochronologic period or lowest chronostratigraphic system attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Neogene / Tertiary / Quaternary
        latestPeriodOrHighestSystem: The full name of the latest possible geochronologic period or highest chronostratigraphic system attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Neogene / Tertiary / Quaternary
        earliestEpochOrLowestSeries: The full name of the earliest possible geochronologic epoch or lowest chronostratigraphic series attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Holocene / Pleistocene / Ibexian Series
        latestEpochOrHighestSeries: The full name of the latest possible geochronologic epoch or highest chronostratigraphic series attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Holocene / Pleistocene / Ibexian Series
        earliestAgeOrLowestStage: The full name of the earliest possible geochronologic age or lowest chronostratigraphic stage attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Atlantic / Boreal / Skullrockian
        latestAgeOrHighestStage: The full name of the latest possible geochronologic age or highest chronostratigraphic stage attributable to the stratigraphic horizon from which the dwc:MaterialEntity was collected. Egs - Atlantic / Boreal / Skullrockian
        lowestBiostratigraphicZone: The full name of the lowest possible geological biostratigraphic zone of the stratigraphic horizon from which the dwc:MaterialEntity was collected.
        highestBiostratigraphicZone: The full name of the highest possible geological biostratigraphic zone of the stratigraphic horizon from which the dwc:MaterialEntity was collected.
        lithostratigraphicTerms: The combination of all litho-stratigraphic names for the rock from which the dwc:MaterialEntity was collected.
        group: The full name of the lithostratigraphic group from which the dwc:MaterialEntity was collected. Egs - Bathurst / Lower Wealden
        formation: The full name of the lithostratigraphic formation from which the dwc:MaterialEntity was collected. Egs - Notch Peak Formation / House Limestone / Fillmore Formation
        member: The full name of the lithostratigraphic member from which the dwc:MaterialEntity was collected. Egs - Lava Dam Member / Hellnmaria Member
        bed: The full name of the lithostratigraphic bed from which the dwc:MaterialEntity was collected.
      Identification:
        identificationID: An identifier for the dwc:Identification (the body of information associated with the assignment of a scientific name). May be a global unique identifier or an identifier specific to the data set.
        verbatimIdentification: A string representing the taxonomic identification as it appeared in the original record. Egs - Peromyscus sp. / Ministrymon sp. nov. 1 / Anser anser × Branta canadensis / Pachyporidae? / Potentilla × pantotricha Soják / Aconitum pilipes × A. variegatum / Lepomis auritus x cyanellus
        identificationQualifier: A brief phrase or a standard term ("cf.", "aff.") to express the determiner's doubts about the dwc:Identification.
        typeStatus: A list (concatenated and separated) of nomenclatural types (type status, typified scientific name, publication) applied to the subject. Egs - holotype of Ctenomys sociabilis. Pearson O. P., and M. I. Christie. 1985. Historia Natural, 5(37):388 / holotype of Pinus abies | holotype of Picea abies
        identifiedBy: A list (concatenated and separated) of names of people, groups, or organizations who assigned the dwc:Taxon to the subject. Egs - James L. Patton / Theodore Pappenfuss | Robert Macey
        identifiedByID: A list (concatenated and separated) of the globally unique identifier for the person, people, groups, or organizations responsible for assigning the dwc:Taxon to the subject.
        dateIdentified: The date on which the subject was determined as representing the dwc:Taxon.
        identificationReferences: A list (concatenated and separated) of references (publication, global unique identifier, URI) used in the dwc:Identification. Egs - Aves del Noroeste Patagonico. Christie et al. 2004. / Stebbins, R. Field Guide to Western Reptiles and Amphibians. 3rd Edition. 2003. | Irschick, D.J. and Shaffer, H.B. (1997). The polytypic species revisited Morphological differentiation among tiger salamanders (Ambystoma tigrinum) (Amphibia Caudata). Herpetologica, 53(1), 30-49.
        identificationVerificationStatus: A categorical indicator of the extent to which the taxonomic identification has been verified to be correct.
        identificationRemarks: Comments or notes about the dwc:Identification.
      Taxon:
        taxonID: An identifier for the set of dwc:Taxon information. May be a global unique identifier or an identifier specific to the data set. Egs - 8fa58e08-08de-4ac1-b69c-1235340b7001 / 32567 / <a href="https://www.gbif.org/species/212">https://www.gbif.org/species/212</a>
        scientificNameID: An identifier for the nomenclatural (not taxonomic) details of a scientific name.
        acceptedNameUsageID: An identifier for the name usage (documented meaning of the name according to a source) of the currently valid (zoological) or accepted (botanical) taxon.
        parentNameUsageID: An identifier for the name usage (documented meaning of the name according to a source) of the direct, most proximate higher-rank parent taxon (in a classification) of the most specific element of the dwc:scientificName.
        originalNameUsageID: An identifier for the name usage (documented meaning of the name according to a source) in which the terminal element of the dwc:scientificName was originally established under the rules of the associated dwc:nomenclaturalCode.
        nameAccordingToID: An identifier for the source in which the specific taxon concept circumscription is defined or implied. See dwc:nameAccordingTo.
        namePublishedInID: An identifier for the publication in which the dwc:scientificName was originally established under the rules of the associated dwc:nomenclaturalCode.
        taxonConceptID: An identifier for the taxonomic concept to which the record refers - not for the nomenclatural details of a dwc:Taxon.
        scientificName: The full scientific name, with authorship and date information if known. When forming part of a dwc:Identification, this should be the name in lowest level taxonomic rank that can be determined. This term should not contain identification qualifications, which should instead be supplied in the dwc:identificationQualifier term. Egs - Coleoptera</code> (order)</li><li class="list-group-item"><code>Vespertilionidae</code> (family)</li><li class="list-group-item"><code>Manis</code> (genus)</li><li class="list-group-item"><code>Ctenomys sociabilis</code> (genus + specificEpithet)</li><li class="list-group-item"><code>Ambystoma tigrinum diaboli</code> (genus + specificEpithet + infraspecificEpithet)</li><li class="list-group-item"><code>Roptrocerus typographi (Györfi, 1952)</code> (genus + specificEpithet + scientificNameAuthorship)</li><li class="list-group-item"><code>Quercus agrifolia var. oxyadenia (Torr.) J.T. Howell</code> (genus + specificEpithet + taxonRank + infraspecificEpithet + scientificNameAuthorship)</li><li class="list-group-item"><code>×Agropogon littoralis (Sm.) C. E. Hubb. / Mentha ×smithiana R. A. Graham / Agrostis stolonifera L. × Polypogon monspeliensis (L.) Desf.
        acceptedNameUsage: The full name, with authorship and date information if known, of the currently valid (zoological) or accepted (botanical) dwc:Taxon.
        parentNameUsage: The full name, with authorship and date information if known, of the direct, most proximate higher-rank parent dwc:Taxon (in a classification) of the most specific element of the dwc:scientificName. Egs - Rubiaceae / Gruiformes / Testudinae
        originalNameUsage: The taxon name, with authorship and date information if known, as it originally appeared when first established under the rules of the associated dwc:nomenclaturalCode. The basionym (botany) or basonym (bacteriology) of the dwc:scientificName or the senior/earlier homonym for replaced names. Egs - Pinus abies / Gasterosteus saltatrix Linnaeus 1768
        nameAccordingTo: The reference to the source in which the specific taxon concept circumscription is defined or implied - traditionally signified by the Latin "sensu" or "sec." (from secundum, meaning "according to"). For taxa that result from identifications, a reference to the keys, monographs, experts and other sources should be given.
        namePublishedIn: A reference for the publication in which the dwc:scientificName was originally established under the rules of the associated dwc:nomenclaturalCode. Egs - Pearson O. P., and M. I. Christie. 1985. Historia Natural, 5(37):388 / Forel, Auguste, Diagnosies provisoires de quelques espèces nouvelles de fourmis de Madagascar, récoltées par M. Grandidier., Annales de la Societe Entomologique de Belgique, Comptes-rendus des Seances 30, 1886
        namePublishedInYear: The four-digit year in which the dwc:scientificName was published. Egs - 1915 / 2008
        higherClassification: A list (concatenated and separated) of taxa names terminating at the rank immediately superior to the referenced dwc:Taxon. Egs - Plantae | Tracheophyta | Magnoliopsida | Ranunculales | Ranunculaceae | Ranunculus / Animalia / Animalia | Chordata | Vertebrata | Mammalia | Theria | Eutheria | Rodentia | Hystricognatha | Hystricognathi | Ctenomyidae | Ctenomyini | Ctenomys
        kingdom: The full scientific name of the kingdom in which the dwc:Taxon is classified. Egs - Animalia / Archaea / Bacteria / Chromista / Fungi / Plantae / Protozoa / Viruses
        phylum: The full scientific name of the phylum or division in which the dwc:Taxon is classified.
        class: The full scientific name of the class in which the dwc:Taxon is classified. Egs - Mammalia / Hepaticopsida
        order: The full scientific name of the order in which the dwc:Taxon is classified. Egs - Carnivora / Monocleales
        superfamily: The full scientific name of the superfamily in which the dwc:Taxon is classified. Egs - Achatinoidea / Cerithioidea / Helicoidea / Hypsibioidea / Valvatoidea / Zonitoidea
        family: The full scientific name of the family in which the dwc:Taxon is classified. Egs - Felidae / Monocleaceae
        subfamily: The full scientific name of the subfamily in which the dwc:Taxon is classified. Egs - Periptyctinae / Orchidoideae / Sphindociinae
        tribe: The full scientific name of the tribe in which the dwc:Taxon is classified. Egs - Ortaliini / Arethuseae
        subtribe: The full scientific name of the subtribe in which the dwc:Taxon is classified. Egs - Plotinini / Typhaeini
        genus: The full scientific name of the genus in which the dwc:Taxon is classified. Egs - Puma / Monoclea
        genericName: The genus part of the dwc:scientificName without authorship.
        subgenus: The full scientific name of the subgenus in which the dwc:Taxon is classified. Values should include the genus to avoid homonym confusion. Egs - Strobus / Amerigo / Pilosella
        infragenericEpithet: The infrageneric part of a binomial name at ranks above species but below genus.
        specificEpithet: The name of the first or species epithet of the dwc:scientificName. Egs - concolor / gottschei
        infraspecificEpithet: The name of the lowest or terminal infraspecific epithet of the dwc:scientificName, excluding any rank designation.
        cultivarEpithet: Part of the name of a cultivar, cultivar group or grex that follows the dwc:scientificName.
        taxonRank: The taxonomic rank of the most specific name in the dwc:scientificName. Egs - subspecies / varietas / forma / species / genus / nothogenus / nothospecies / nothosubspecies
        verbatimTaxonRank: The taxonomic rank of the most specific name in the dwc:scientificName as it appears in the original record. Egs - Agamospecies / sub-lesus / prole / apomict / nothogrex / sp. / subsp. / var.
        scientificNameAuthorship: The authorship information for the dwc:scientificName formatted according to the conventions of the applicable dwc:nomenclaturalCode. Egs - (Torr.) J.T. Howell / (Martinovský) Tzvelev / (Györfi, 1952)
        vernacularName: A common or vernacular name. Egs - Andean Condor / Condor Andino / American Eagle / Gänsegeier
        nomenclaturalCode: The nomenclatural code (or codes in the case of an ambiregnal name) under which the dwc:scientificName is constructed. Egs - ICN / ICZN / BC / ICNCP / BioCode
        taxonomicStatus: The status of the use of the dwc:scientificName as a label for a taxon. Requires taxonomic opinion to define the scope of a dwc:Taxon. Rules of priority then are used to define the taxonomic status of the nomenclature contained in that scope, combined with the experts opinion. It must be linked to a specific taxonomic reference that defines the concept. Egs - invalid / misapplied / homotypic synonym / accepted
        nomenclaturalStatus: The status related to the original publication of the name and its conformance to the relevant rules of nomenclature. It is based essentially on an algorithm according to the business rules of the code. It requires no taxonomic opinion. Egs - nom. ambig. / nom. illeg. / nom. subnud.
        taxonRemarks: Comments or notes about the taxon or name.
      MeasurementOrFact:
        measurementID: An identifier for the dwc:MeasurementOrFact (information pertaining to measurements, facts, characteristics, or assertions). May be a global unique identifier or an identifier specific to the data set.
        parentMeasurementID: An identifier for a broader dwc:MeasurementOrFact that groups this and potentially other dwc:MeasurementOrFacts. Egs - 9c752d22-b09a-11e8-96f8-529269fb1459 / E1_E1_O1_M1
        measurementType: The nature of the measurement, fact, characteristic, or assertion. Egs - tail length / temperature / trap line length / survey area / trap type
        measurementValue: The value of the measurement, fact, characteristic, or assertion. Egs - 45 / 20 / 1 / 14.5 / UV-light
        measurementAccuracy: The description of the potential error associated with the dwc:measurementValue. Egs - 0.01 / normal distribution with variation of 2 m
        measurementUnit: The units associated with the dwc:measurementValue. Egs - m / g / l / °C / mm / km² / % / hh:mm:ss
        measurementDeterminedBy: A list (concatenated and separated) of names of people, groups, or organizations who determined the value of the dwc:MeasurementOrFact. Egs - Rob Guralnick / Peter Desmet | Stijn Van Hoey
        measurementDeterminedDate: The date on which the dwc:MeasurementOrFact was made.
        measurementMethod: A description of or reference to (publication, URI) the method or protocol used to determine the measurement, fact, characteristic, or assertion.
        measurementRemarks: Comments or notes accompanying the dwc:MeasurementOrFact.
      ---

      Take a deep breath, and methodically go through each of the columns in this Table: 
      1) Make sure that each column heading corresponds to a Darwin Core term
      2) Check the date columns and make sure they are valid dates. If there are one or two invalid dates, try to correct them. Make sure dates are in ISO format Y-m-d
      3) Check decimalLatitude and decimalLongitude (if present), do any conversion necessary

- model: api.task
  fields:
    name: adhoc_processing
    per_table: false
    attempt_autonomous: false
    text: |-
      Carefully inspect these preprocessed dataframes. They should be nearly ready for publication. 

      Helpful examples - pay close attention:
      We want to produce Tables like one of these examples:

      Example 1, standalone occurrence data:
      | recordedBy    | year | month | day | continent | country | stateProvince | decimalLatitude | decimalLongitude | coordinateUncertaintyInMeters | identifiedBy  | scientificName         | kingdom |
      | ------------- | ---- | ----- | --- | --------- | ------- | ------------- | --------------- | ---------------- | ----------------------------- | ------------- | ---------------------- | ------- |
      | Wesenberg, J. | 2010 | 6     | 18  | Europe    | Norway  | Akershus      | 59.931848       | 10.571654        | 10                            | Wesenberg, J. | Acer platanoides       | Plantae |
      | Wesenberg, J. | 2010 | 6     | 18  | Europe    | Norway  | Akershus      | 59.931848       | 10.571654        | 10                            | Wesenberg, J. | Achillea millefolium   | Plantae |
      | Wesenberg, J. | 2010 | 6     | 18  | Europe    | Norway  | Akershus      | 59.931848       | 10.571654        | 10                            | Wesenberg, J. | Alchemilla glaucescens | Plantae |
      | Wesenberg, J. | 2010 | 6     | 18  | Europe    | Norway  | Akershus      | 59.931848       | 10.571654        | 10                            | Wesenberg, J. | Anemone  nemorosa      | Plantae |
      | Wesenberg, J. | 2010 | 6     | 18  | Europe    | Norway  | Akershus      | 59.931848       | 10.571654        | 10                            | Wesenberg, J. | Avenula pubescens      | Plantae |

      Example 2, occurrence data with measurement or fact data:
      occurrence.csv:
      | basisOfRecord    | occurrenceID                                  | recordNumber     | recordedBy | country | locality | decimalLatitude | decimalLongitude | coordinateUncertaintyInMeters                                      | footprintWKT                  | identifiedBy       | scientificName | kingdom |
      | ---------------- | --------------------------------------------- | ---------------- | ---------- | ------- | -------- | --------------- | ---------------- | ------------------------------------------------------------------ | ----------------------------- | ------------------ | -------------- | ------- |
      | HumanObservation | 1 | Rhoda Nankabirwa | Uganda     | Kituuza | 0.254    | 32.788          | 600              | POLYGON ((32.779 0.261, 32.779 0.250, 32.798 0.250, 32.798 0.261)) | Makerere University Herbarium | Albizzia sp        | Animalia       |
      | HumanObservation | 2 | Rhoda Nankabirwa | Uganda     | Kituuza | 0.254    | 32.788          | 600              | POLYGON ((32.779 0.261, 32.779 0.250, 32.798 0.250, 32.798 0.261)) | Makerere University Herbarium | Antiaris toxicaria | Animalia       |
      | HumanObservation | 3 | Rhoda Nankabirwa | Uganda     | Kituuza | 0.254    | 32.788          | 600              | POLYGON ((32.779 0.261, 32.779 0.250, 32.798 0.250, 32.798 0.261)) | Makerere University Herbarium | Antiaris toxicaria | Animalia       |

      measurementorfact.csv, with the ids relating back to the main occurrence table:
      | id                                            | measurementType  | measurementValue | measurementUnit |
      | --------------------------------------------- | ---------------- | ---------------- | --------------- |
      | 1 | tree diameter | 25.1             | cm              |
      | 2 | tree diameter | 22               | cm              |
      | 3 | tree diameter | 42               | cm              |
      | 1 | tree height   | 200              | cm              |

      Example 3, taxonomy checklist data:
      | taxonID | scientificName            |
      | ------- | ------------------------- |
      | 1585    | Triturus cristatus        |
      | 1601    | Coronella austriaca       |
      | 1621    | Acanthonotozoma rusanovae |
      | 1670    | Apolochus borealis        |
      | 1724    | Nototropis smitti         |


      Are there any outstanding issues you can see? Fix these and up, and then when you and the user are satisfied with the data tables publish the dataset using PublishDwC. 

      Be sure to warn the user that the publication process may take some time. 
      When the dataset is published, generate a congratulatory message with: 
      1. A small piece of celebratory ascii art
      3. The DOI/URL to the dataset (returned from PublishDwC)
      3. A message to let the user know that the dataset occurrence points will take some time (possibly 30 minutes) to populate after publication
      4. Another message asking if they would like to make any edits, or upload a new dataset, and then call SetAgentTaskToComplete
    additional_function: PublishDwC

# - model: api.task
#   fields:
#     name: set_basic_metadata
#     per_table: false
#     attempt_autonomous: false
#     text: |-
#       Examine the data presented in these tables carefully and the current dataset Description (a draft with some information about columns and data structure), and use it to derive a very short but descriptive draft Title (max 50 words) and Description (approx 3-5 sentences) for the dataset as a whole. Incorporate the current dataset Description and keep information about the columns and data structure at the end of the Description. But you can ignore the data structure in sheets - that will change, just focus on the contents of the data. Ask the user to improve your Title and Description, and finalise in consultation with them before saving to the database using SetBasicMetadata.
#     additional_function: SetBasicMetadata

# - model: api.task
#   fields:
#     name: check_data_suitability
#     per_table: false
#     attempt_autonomous: false
#     text: |-
#       GBIF.org is a global database for biodiversity data. Suitable data for publication includes:
#       - Species Occurrence Data and Sampling Event Data: Records of WHEN (columns for year/month/day, date, etc) and WHERE (columns for locality, latitude/longitude, footprintwkt, etc) a species/WHAT (columns for taxonomy, scientific name, or even higher level taxonomy like Family or Order, etc) was observed or collected. Often also includes WHO made the observation (collector, citizen scientist, researcher, etc) - these may also be e.g. eDNA data even if the species identification only occurs at a higher taxonomic level.
#       - Checklists: Lists of species found in a specific area or ecosystem.
#       Look at this data, especially the column headings, and the metadata description critically. 
#       Is this data suitable for publication on gbif.org? If it is, mark this Task as complete, otherwise let the user know and reject the the dataset using the RejectDataset function. 
#     additional_function: RejectDataset

# - model: api.task
#   fields: 
#     name: delete_unnecessary_tables
#     per_table: false
#     attempt_autonomous: true
#     text: >
#       Delete any tables which are not primary data - i.e. which can be derived from other tables. If the data is cryptic or the column headers are not obvious check with the user before doing a deletion. 


# - model: api.task
#   fields:
#     name: flatten_headers
#     per_table: true
#     attempt_autonomous: true
#     text: >
#       Flatten any of the top rows which you think might contain header information into a single row (try to preserve as much information as possible), and convert it to the dataframe header. If there is more than two candidate header rows, rearrange the data , for example: 

#       Original table: 

#       WP2	 64 µm mesh (ind m-3)			
#       Date	2017	2017	2018	2018
#       Sample/Net number	AVERAGE 20-21.02.17	AVERAGE 20-21.02.17	12.06.2018	12.06.2018
#       Layer [m]	50-0 m	170-50 m	50-0 m	170-50 m
#       Calanus spp.	128	259	194	562
#       Microcalanus spp.	471	707	16	125
#       Cyclopoida nauplii	8724	9	8061	2
#       Fritillaria borealis	5560	2	0	0
#       Rotatoria	607	25	0	0
#       SUM Others	16721	84	223	32

#       Resulting table:
#       Date	Sample/Net number	Layer [m]	Calanus spp.	Microcalanus spp.	Cyclopoida nauplii	Fritillaria borealis	Rotatoria	SUM Others
#       2017	AVERAGE 20-21.02.17	50-0 m	128	471	8724	5560	607	16721
#       2017	AVERAGE 20-21.02.17	170-50 m	259	707	9	2	25	84
#       2018	12.06.2018	50-0 m	194	16	8061	0	0	223
#       2018	12.06.2018	170-50 m	562	125	2	0	0	32

